<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Paul Peninon - Interactive Portfolio</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Crimson+Pro:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-dark: #0a0e27;
            --bg-secondary: #1a1f3a;
            --color-work: #3b82f6;      
            --color-edu: #fbbf24;        
            --color-visited: #9ca3af;   
            --text-light: #e5e7eb;
            --text-gray: #9ca3af;
            --text-white: #ffffff;
            --map-line: #374151;
        }

        body {
            font-family: 'Crimson Pro', serif;
            background: linear-gradient(135deg, var(--bg-dark) 0%, #0f1629 50%, var(--bg-secondary) 100%);
            color: var(--text-light);
            overflow-x: hidden;
            min-height: 100vh;
        }

        /* --- OPTIMISATION 1: Animation plus l√©g√®re --- */
        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }

        .star {
            position: absolute;
            width: 20px;
            height: auto;
            opacity: 0;
            /* Suppression des filtres lourds (grayscale/brightness) pour la performance */
            will-change: transform, opacity; /* Force l'utilisation du GPU */
            transform: translateZ(0); /* Active l'acc√©l√©ration mat√©rielle */
            animation: twinkle 5s infinite ease-in-out; /* Animation un peu plus lente pour moins ramer */
        }

        @keyframes twinkle {
            0% { opacity: 0; transform: scale(0.6) rotate(-5deg); }
            50% { opacity: 0.6; transform: scale(1) rotate(5deg); } /* Opacit√© max r√©duite √† 0.6 */
            100% { opacity: 0; transform: scale(0.6) rotate(-5deg); }
        }

        /* --- Header --- */
        header {
            position: relative;
            z-index: 10;
            padding: 2.5rem 2rem;
            border-bottom: 1px solid rgba(55, 65, 81, 0.5);
            background: rgba(10, 14, 39, 0.9); /* Moins de transparence = moins de calcul de flou */
            backdrop-filter: blur(8px); /* Blur r√©duit pour gagner des FPS */
        }

        .header-content {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 2.5rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .profile-photo {
            width: 140px;
            height: 140px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid var(--color-work);
            box-shadow: 0 0 25px rgba(59, 130, 246, 0.4);
            flex-shrink: 0;
        }

        .header-text { flex-grow: 1; max-width: 800px; }

        h1 {
            font-size: 3.5rem;
            font-weight: 700;
            margin-bottom: 0.2rem;
            background: linear-gradient(135deg, var(--text-white), var(--color-work));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .subtitle {
            font-family: 'Space Mono', monospace;
            font-size: 1rem;
            color: var(--text-gray);
            text-transform: uppercase;
            margin-bottom: 1.2rem;
            letter-spacing: 1px;
        }

        .contact-info { display: flex; gap: 1.5rem; flex-wrap: wrap; font-size: 0.9rem; }
        .contact-item { display: flex; align-items: center; gap: 5px; }
        .contact-item a { color: var(--color-work); text-decoration: none; transition: 0.3s; }
        .contact-item a:hover { color: var(--text-white); text-decoration: underline; }

        /* --- Map Container --- */
        .map-wrapper {
            position: relative;
            max-width: 1400px;
            height: 75vh;
            min-height: 600px;
            margin: 3rem auto;
            border-radius: 24px;
            overflow: hidden;
            border: 1px solid var(--map-line);
            box-shadow: 0 20px 50px rgba(0,0,0,0.6);
            z-index: 5;
            display: flex;
        }

        .locations-sidebar {
            width: 280px;
            background: rgba(10, 14, 39, 0.95);
            /* backdrop-filter retir√© ici pour fluidifier le scroll de la liste */
            border-right: 1px solid var(--map-line);
            overflow-y: auto;
            z-index: 1002;
        }

        .sidebar-header {
            padding: 1.5rem;
            font-family: 'Space Mono', monospace;
            font-size: 0.85rem;
            text-transform: uppercase;
            color: var(--text-gray);
            border-bottom: 1px solid rgba(255,255,255,0.1);
            background: rgba(10, 14, 39, 1);
            position: sticky; /* Garde le titre visible */
            top: 0;
        }

        .location-item {
            padding: 1.2rem 1.5rem;
            cursor: pointer;
            border-bottom: 1px solid rgba(255,255,255,0.05);
            transition: background 0.2s ease; /* Transition simplifi√©e */
        }

        .location-item:hover { background: rgba(59, 130, 246, 0.15); }
        .location-item h4 { font-size: 1rem; color: var(--text-white); margin-bottom: 0.2rem; }
        .location-item span { font-size: 0.8rem; color: var(--text-gray); }

        .loc-dot {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 10px;
        }

        #map { flex-grow: 1; height: 100%; background: #0a0e27; }

        /* --- Info Card --- */
        .info-card {
            position: absolute;
            top: 25px;
            right: 25px;
            width: 380px;
            max-width: 90%;
            max-height: 85%;
            overflow-y: auto;
            background: rgba(20, 25, 48, 0.95);
            /* Blur r√©duit */
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 20px;
            transform: translateX(120%);
            transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1); /* Dur√©e r√©duite */
            z-index: 1000;
            box-shadow: -15px 15px 40px rgba(0,0,0,0.7);
        }

        .info-card.active { transform: translateX(0); }
        .card-image-container { width: 100%; height: 200px; }
        .card-image { width: 100%; height: 100%; object-fit: cover; }
        .card-content { padding: 1.8rem; }
        .info-card h3 { font-size: 1.4rem; color: var(--text-white); margin-bottom: 0.6rem; }
        .info-card .meta { font-family: 'Space Mono', monospace; font-size: 0.75rem; color: var(--text-gray); border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 1rem; margin-bottom: 1rem; }
        .highlight { color: var(--color-work); font-weight: bold; }
        .edu-card .highlight { color: var(--color-edu); }
        
        .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(0,0,0,0.6);
            border: none;
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            cursor: pointer;
            z-index: 10;
            font-size: 1.2rem;
        }

        /* --- Map Legend --- */
        .map-legend {
            position: absolute;
            bottom: 25px;
            left: 305px;
            background: rgba(10, 14, 39, 0.95);
            padding: 1rem 1.2rem;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            z-index: 1000;
            font-family: 'Space Mono', monospace;
            font-size: 0.75rem;
        }

        .legend-item { display: flex; align-items: center; gap: 10px; margin-bottom: 6px; }
        .dot { width: 12px; height: 12px; border-radius: 50%; }
        .dot.visited { background: var(--color-visited); }
        .dot.work { background: var(--color-work); }
        .dot.edu { background: var(--color-edu); }

        /* Custom Markers */
        .custom-marker-icon { background: transparent; border: none; }
        .marker-pulse {
            position: relative;
            width: 18px;
            height: 18px;
            background: currentColor;
            border-radius: 50%;
            /* Ombre simplifi√©e pour perf */
            box-shadow: 0 0 10px currentColor; 
        }
        .marker-pulse::after {
            content: ''; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 100%; height: 100%; border-radius: 50%; border: 2px solid currentColor;
            animation: ripple 2.5s infinite;
        }
        @keyframes ripple { 0% { width: 100%; height: 100%; opacity: 1; } 100% { width: 250%; height: 250%; opacity: 0; } }
        .marker-work { color: var(--color-work); }
        .marker-edu { color: var(--color-edu); }
        .marker-visited { color: var(--color-visited); width: 10px; height: 10px; box-shadow: none; }
        .marker-visited::after { display: none; }

        /* Grid for skills */
        .content-section { max-width: 1200px; margin: 0 auto 5rem; padding: 0 2rem; }
        .grid-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 2.5rem; }
        .card { background: rgba(26, 31, 58, 0.6); border: 1px solid rgba(96, 165, 250, 0.1); border-radius: 20px; padding: 2.5rem; transition: transform 0.3s; }
        .card:hover { transform: translateY(-5px); border-color: var(--color-work); background: rgba(26, 31, 58, 0.85); }
        .card h2 { font-family: 'Space Mono', monospace; font-size: 1.1rem; color: var(--color-work); text-transform: uppercase; margin-bottom: 2rem; letter-spacing: 2px; }
        .skill-item { margin-bottom: 1.5rem; }
        .skill-header { display: flex; justify-content: space-between; margin-bottom: 0.5rem; font-size: 0.9rem; }
        .progress-bar { height: 6px; background: rgba(255,255,255,0.1); border-radius: 10px; overflow: hidden; }
        .progress-fill { height: 100%; background: var(--color-work); width: 0; transition: width 1.5s cubic-bezier(0.1, 0, 0.2, 1); }
        .tags { display: flex; flex-wrap: wrap; gap: 0.8rem; }
        .tag { background: rgba(59, 130, 246, 0.15); color: var(--color-work); padding: 0.6rem 1.2rem; border-radius: 30px; font-size: 0.85rem; font-family: 'Space Mono', monospace; border: 1px solid rgba(59, 130, 246, 0.2); }

        @media (max-width: 1024px) { .map-legend { left: 20px; bottom: 80px; } }
        @media (max-width: 768px) {
            h1 { font-size: 2.5rem; }
            .map-wrapper { flex-direction: column; height: 85vh; }
            .locations-sidebar { width: 100%; height: 180px; border-right: none; border-bottom: 1px solid var(--map-line); }
            .map-legend { left: 15px; bottom: 15px; }
            .info-card { width: 100%; right: 0; bottom: 0; top: auto; transform: translateY(110%); border-radius: 24px 24px 0 0; }
            .info-card.active { transform: translateY(0); }
            .header-content { flex-direction: column; text-align: center; }
            .contact-info { justify-content: center; }
        }
    </style>
</head>
<body>

    <div class="stars" id="stars"></div>

    <header>
        <div class="header-content">
            <img src="profile.jpg" alt="Paul Peninon" class="profile-photo">
            <div class="header-text">
                <h1>Paul Peninon</h1>
                <p class="subtitle">International Sport Administration Student</p>
                <div class="contact-info">
                    <div class="contact-item">üìß <a href="mailto:peninon.paul@gmail.com">peninon.paul@gmail.com</a></div>
                    <div class="contact-item">üì± +33 6 01 85 89 33</div>
                    
                    <div class="contact-item">üìÑ <a href="Paul-Peninon-Resume.pdf" target="_blank" download>Download my CV</a></div>
                    
                    <div class="contact-item">üîó <a href="https://www.linkedin.com/in/paul-peninon-612a1a1b1/" target="_blank">LinkedIn</a></div>
                    <div class="contact-item">üå≤ <a href="https://linktr.ee/peninon.paul" target="_blank">Linktree</a></div>
                </div>
            </div>
        </div>
    </header>

    <div class="map-wrapper">
        <div class="locations-sidebar" id="sidebar">
            <div class="sidebar-header">Experiences</div>
        </div>
        <div id="map"></div>
        <div class="map-legend">
            <div class="legend-item"><span class="dot work"></span> Work</div>
            <div class="legend-item"><span class="dot edu"></span> Education</div>
            <div class="legend-item"><span class="dot visited"></span> Visited</div>
        </div>

        <div class="info-card" id="infoCard">
            <button class="close-btn" onclick="closeCard()">√ó</button>
            <div class="card-image-container" id="cardImgContainer" style="display:none;">
                <img src="" alt="Experience Image" class="card-image" id="cardImg">
            </div>
            <div class="card-content">
                <h3 id="cardTitle">Title</h3>
                <div class="meta">
                    <span class="highlight" id="cardCompany">Company</span><br>
                    <span id="cardLocation">Location</span> ‚Ä¢ <span id="cardPeriod">Date</span>
                </div>
                <div id="cardDesc" style="font-size: 0.95rem; line-height: 1.6; color: var(--text-gray);">Description</div>
                <ul id="cardTasks" style="list-style: none; margin-top: 1.2rem;"></ul>
            </div>
        </div>
    </div>

    <div class="content-section">
        <div class="grid-container">
            <div class="card">
                <h2>Languages</h2>
                <div class="skill-item">
                    <div class="skill-header"><span>French (Native)</span><span>100%</span></div>
                    <div class="progress-bar"><div class="progress-fill" style="width: 100%"></div></div>
                </div>
                <div class="skill-item">
                    <div class="skill-header"><span>English (C1 - TOEIC 985)</span><span>95%</span></div>
                    <div class="progress-bar"><div class="progress-fill" style="width: 95%"></div></div>
                </div>
                <div class="skill-item">
                    <div class="skill-header"><span>German (B1)</span><span>60%</span></div>
                    <div class="progress-bar"><div class="progress-fill" style="width: 60%"></div></div>
                </div>
            </div>

            <div class="card">
                <h2>Digital Skills</h2>
                <div class="tags">
                    <span class="tag">MS Office</span><span class="tag">Canva</span><span class="tag">SEO</span>
                    <span class="tag">E-commerce Mgmt</span><span class="tag">Social Media</span><span class="tag">Marketing</span><span class="tag">Event organisation</span>
                </div>
            </div>

            <div class="card">
                <h2>Interests</h2>
                <ul style="list-style: none;">
                    <li style="margin-bottom: 1.2rem; display: flex; align-items: center; gap: 15px;">
                        <span style="font-size: 1.5rem;">üèÄ</span> 
                        <div><strong>Sports</strong><br><span style="color: var(--text-gray);">Basketball & Tennis</span></div>
                    </li>
                    <li style="margin-bottom: 1.2rem; display: flex; align-items: center; gap: 15px;">
                        <span style="font-size: 1.5rem;">üéÆ</span> 
                        <div><strong>Esport</strong><br><span style="color: var(--text-gray);">Top 500 Europe - TFT</span></div>
                    </li>
                    <li style="display: flex; align-items: center; gap: 15px;">
                        <span style="font-size: 1.5rem;">‚úàÔ∏è</span> 
                        <div><strong>Travel</strong><br><span style="color: var(--text-gray);">International explorer</span></div>
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <script>
        // --- 1. Flags Animation Optimized ---
        // OPTIMIZATION: Reduced from 120 to 40 particles for performance
        const starsContainer = document.getElementById('stars');
        const myCountries = ['fr', 'lu', 'de', 'ca', 'us', 'jp', 'gb', 'tz', 'tn', 'es', 'it', 'gr', 'be', 'ie'];
        
        for (let i = 0; i < 40; i++) {
            const flag = document.createElement('img');
            const country = myCountries[Math.floor(Math.random() * myCountries.length)];
            flag.className = 'star';
            flag.src = `https://flagcdn.com/w40/${country}.png`;
            flag.style.left = Math.random() * 100 + '%';
            flag.style.top = Math.random() * 100 + '%';
            // Increased delay slightly for smoother feel
            flag.style.animationDelay = Math.random() * 5 + 's';
            flag.style.width = (15 + Math.random() * 15) + 'px';
            starsContainer.appendChild(flag);
        }

        // --- 2. Resume Data (Ordered) ---
        // UPDATED: Fleshed out descriptions and tasks for a professional portfolio look
        const experiences = [
            // 1. University of Lille
            { 
                id: 2, 
                
                title: "Master International Sport Administration", 
                company: "University of Lille", 
                type: "edu", 
                period: "2024 - 2026", 
                location: "Lille, France", 
                lat: 50.6800, 
                lng: 3.1400, 
                desc: "Specialized Master's program focusing on the global governance of sports. This curriculum integrates high-level strategic management, international law, and the economic challenges of the modern sports industry.", 
                tasks: [
                    "Strategic management of international sports organizations and major events",
                    "In-depth analysis of Sports Law, governance, and public policy frameworks",
                    "Consultancy-style project development for leisure and professional sports industries",
                    "Advanced international sports marketing, sponsorship, and fan engagement strategies",
                    "Economic impact assessment of territorial sports development projects"
                ], 
                image: "Staps.jpg" 
            },
            // 2. Okanagan
            { 
                id: 8, 
                title: "International Semester", 
                company: "Okanagan College", 
                type: "edu", 
                period: "2019-2023", 
                location: "Kelowna, Canada", 
                lat: 49.8880, 
                lng: -119.4960, 
                desc: "Academic exchange focused on North American business models. This experience provided deep cultural immersion and a comprehensive understanding of the Canadian business ecosystem.", 
                tasks: [
                    "Advanced courses in Business Administration, Consumer Behavior, and Digital Marketing",
                    "Full professional and linguistic immersion in an Anglophone academic environment",
                    "Cross-cultural collaboration through multi-disciplinary team projects",
                    "Comparative analysis of North American vs. European marketing and consumer trends",
                    "Development of adaptability and international networking skills"
                ], 
                image: "OC.jpg" 
            },
            // 3. INSEEC
            { 
                id: 6, 
                title: "BBA INSEEC", 
                company: "INSEEC Business School", 
                type: "edu", 
                period: "2019 - 2023", 
                location: "Bordeaux, France", 
                lat: 44.8900, 
                lng: -0.5400, 
                desc: "Four-year Bachelor of Business Administration providing a robust foundation in international commerce, finance, and management through a 'learning by doing' pedagogical approach.", 
                tasks: [
                    "Specialization in International Marketing and Global Brand Strategy",
                    "Creation of a comprehensive Start-up Business Plan (Finance, HR, and Marketing)",
                    "Executive member of the Sports Bureau (BDS): budgeting and internal promotion",
                    "Full-scale organization of student sports tournaments and community events",
                    "Market research and competitive benchmarking for various business sectors"
                ], 
                image: "BBA.jpg" 
            },
            // 4. Decathlon
            { 
                id: 1, 
                title: "Summer Job - Production", 
                company: "Decathlon (Van Rysel Factory)", 
                type: "work", 
                period: "June 2025 - Sept 2025", 
                location: "Lille, France", 
                lat: 50.5600, 
                lng: 2.9800, 
                desc: "Technical role within the Van Rysel manufacturing unit (B'Twin Village), contributing to the production chain of high-performance road bikes for professional and amateur athletes.", 
                tasks: [
                    "Precision assembly of high-end Van Rysel road bikes following technical blueprints",
                    "Rigorous quality control and compliance checks to meet international safety standards",
                    "Application of LEAN Management principles to optimize production flow and efficiency",
                    "Management of technical workstations and inventory replenishment for assembly lines",
                    "Collaboration with the R&D team to provide feedback on assembly ergonomics"
                ], 
                image: "Van Rysel.jpg" 
            },
            // 5. Handball
            { 
                id: 3, 
                title: "Communication & Assistant CEO", 
                company: "Handball Club Diddeleng", 
                type: "work", 
                period: "April 2025 - June 2025", 
                location: "Dudelange, Luxembourg", 
                lat: 49.4806, 
                lng: 6.0842, 
                desc: "Strategic support role to the club's leadership, focusing on professionalizing the club's image and expanding its inclusive sports initiatives at a national and European level.", 
                tasks: [
                    "Development and execution of the club's 2025 strategic growth roadmap",
                    "Full logistics management for the 'European Youth Cup' (accommodation, transport, schedules)",
                    "Strategic communication and visibility plan for the Wheelchair Handball section",
                    "B2B partner activation and development of new sponsorship packages",
                    "Social media management and creation of digital content for matchday events"
                ], 
                image: "HBD.jpg" 
            },
            // 6. Unis Cit√©
            { 
                id: 4, 
                title: "Voluntary Community Service", 
                company: "Unis Cit√©", 
                type: "work", 
                period: "Sept 2023 - June 2024", 
                location: "Bordeaux, France", 
                lat: 44.7900, 
                lng: -0.6200, 
                desc: "Civic service mission 'Cinema & Citizenship' (CNC partnership). Using cinema as a medium to foster critical thinking and social dialogue among young people in educational priority areas.", 
                tasks: [
                    "Planning and facilitating 'Cin√©-D√©bat' sessions for over 500 high school students",
                    "Designing interactive workshops on sensitive societal issues (ecology, diversity, ethics)",
                    "Mentoring youth on civic engagement and encouraging social responsibility",
                    "Public speaking and moderation of large groups to encourage inclusive dialogue",
                    "Coordinating logistics for national events and inter-associative partnerships"
                ], 
                image: "Community service.png" 
            },
            // 7. Medical Thiry
            { 
                id: 5, 
                title: "Work-study Communication", 
                company: "M√©dical-Thiry", 
                type: "work", 
                period: "Sept 2022 - Sept 2023", 
                location: "Martignas-sur-Jalle, France", 
                lat: 44.8400, 
                lng: -0.7700, 
                desc: "Year-long work-study contract managing the 360¬∞ digital strategy for a leader in medical equipment distribution, balancing B2B professional needs with B2C customer service.", 
                tasks: [
                    "Comprehensive Social Media Management and Community building across all platforms",
                    "Daily management of the PrestaShop e-commerce platform (product updates, UX/UI)",
                    "Content strategy: SEO-optimized blog writing and technical product descriptions",
                    "Design and deployment of monthly newsletters and targeted Google Ads campaigns",
                    "Performance tracking and data analysis of digital marketing KPIs"
                ], 
                image: "mt.jpg" 
            },
            // 8. Steel Vintage Bikes
            { 
                id: 7, 
                title: "Marketing Internship", 
                company: "Steel Vintage Bikes", 
                type: "work", 
                period: "Jan 2021 - Mar 2021", 
                location: "Berlin, Germany", 
                lat: 52.5200, 
                lng: 13.4050, 
                desc: "International marketing role in a high-growth cycling company in Berlin. Focused on building brand loyalty within the global vintage cycling community.", 
                tasks: [
                    "Daily engagement for a global community of +170k followers on Instagram",
                    "Co-development of editorial calendars and visual content for international launches",
                    "Assisting in the launch of new apparel collections and limited edition bicycle builds",
                    "SEO copywriting and translation of marketing materials (English and German)",
                    "Monitoring of market trends in the niche luxury and vintage cycling industry"
                ],
                image: "SVB.jpg"
           
            }
        ];

        const visited = [
            {lat: 40.7128, lng: -74.0060, name: "USA"}, {lat: 35.6762, lng: 139.6503, name: "Japan"},
            {lat: 51.5074, lng: -0.1278, name: "UK"}, {lat: -6.3690, lng: 34.8888, name: "Tanzania"},
            {lat: 36.8065, lng: 10.1815, name: "Tunisia"}, {lat: 40.4168, lng: -3.7038, name: "Spain"},
            {lat: 41.9028, lng: 12.4964, name: "Italy"}, {lat: 37.9838, lng: 23.7275, name: "Greece"},
            {lat: 50.8503, lng: 4.3517, name: "Belgium"}, {lat: 53.3498, lng: -6.2603, name: "Ireland"}
        ];

        // --- 3. Initialize Map ---
        const map = L.map('map', {
            center: [25, 0], 
            zoom: 2,
            minZoom: 2,
            zoomControl: true,
            scrollWheelZoom: false,
            worldCopyJump: true
        });

        L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
            attribution: '&copy; CARTO',
            subdomains: 'abcd',
            maxZoom: 19
        }).addTo(map);

        // --- 4. Sidebar & Marker Generation ---
        const sidebar = document.getElementById('sidebar');
        experiences.forEach(exp => {
            const item = document.createElement('div');
            item.className = 'location-item';
            const dotClass = exp.type === 'work' ? 'work' : 'edu';
            item.innerHTML = `<h4><span class="loc-dot ${dotClass}"></span>${exp.company}</h4><span>${exp.location}</span>`;
            item.onclick = () => { showCard(exp); map.flyTo([exp.lat, exp.lng], 9, { duration: 1.5 }); };
            sidebar.appendChild(item);

            const colorClass = exp.type === 'work' ? 'marker-work' : 'marker-edu';
            const icon = L.divIcon({
                className: 'custom-marker-icon',
                html: `<div class="marker-pulse ${colorClass}"></div>`,
                iconSize: [20, 20], iconAnchor: [10, 10]
            });

            L.marker([exp.lat, exp.lng], {icon: icon}).addTo(map).on('click', (e) => {
                L.DomEvent.stopPropagation(e);
                showCard(exp);
                map.flyTo([exp.lat, exp.lng], 9, { duration: 1.5 });
            });
        });

        visited.forEach(place => {
            const icon = L.divIcon({
                className: 'custom-marker-icon',
                html: `<div class="marker-pulse marker-visited"></div>`,
                iconSize: [10, 10], iconAnchor: [5, 5]
            });
            L.marker([place.lat, place.lng], {icon: icon}).addTo(map)
             .bindTooltip(place.name, { direction: 'top', className: 'leaflet-tooltip-dark' });
        });

        // --- 5. Card Logic ---
        const card = document.getElementById('infoCard');
        const cardImg = document.getElementById('cardImg');
        const cardImgContainer = document.getElementById('cardImgContainer');
        
        function showCard(data) {
            card.className = data.type === 'edu' ? 'info-card edu-card' : 'info-card';
            if (data.image) { cardImg.src = data.image; cardImgContainer.style.display = 'block'; } 
            else { cardImgContainer.style.display = 'none'; }

            document.getElementById('cardTitle').innerText = data.title;
            document.getElementById('cardCompany').innerText = data.company;
            document.getElementById('cardPeriod').innerText = data.period;
            document.getElementById('cardLocation').innerText = data.location;
            document.getElementById('cardDesc').innerText = data.desc;
            
            const tasksList = document.getElementById('cardTasks');
            tasksList.innerHTML = '';
            data.tasks.forEach(task => {
                const li = document.createElement('li');
                li.style.cssText = "position:relative; padding-left:20px; margin-bottom:8px; font-size:0.9rem;";
                li.innerHTML = `<span style="position:absolute; left:0; color:var(--color-work);">‚ñπ</span>${task}`;
                tasksList.appendChild(li);
            });
            card.classList.add('active');
        }

        function closeCard() { card.classList.remove('active'); }
        map.on('click', () => closeCard());

        // Animate bars
        document.querySelectorAll('.progress-fill').forEach(bar => {
            const width = bar.style.width;
            bar.style.width = '0';
            setTimeout(() => { bar.style.width = width; }, 600);
        });

    </script>
</body>
</html>
